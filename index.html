<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Add to Calendar</title>
    <style>
        body { font-family: -apple-system, system-ui, sans-serif; text-align: center; padding: 40px 20px; background: #f4f7f9; color: #333; }
        .card { background: white; padding: 30px; border-radius: 24px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); max-width: 350px; margin: auto; }
        h2 { margin: 0 0 10px 0; color: #000; font-size: 24px; }
        p { margin: 0 0 25px 0; color: #666; font-size: 16px; line-height: 1.4; }
        .btn { display: block; padding: 16px; margin: 12px 0; border-radius: 12px; text-decoration: none; font-weight: bold; color: white; font-size: 16px; transition: transform 0.1s; }
        .btn:active { transform: scale(0.98); }
        .outlook { background: #0078d4; }
        .google { background: #34a853; }
        .default { background: #555; }
    </style>
</head>
<body>
    <div class="card">
        <h2 id="title">Event Name</h2>
        <p id="details"></p>
        
        <a id="outLink" class="btn outlook" href="#">Add to Outlook</a>
        <a id="gooLink" class="btn google" href="#">Add to Google</a>
        <a id="icsLink" class="btn default" href="#">Add to Default Calendar</a>
    </div>

    <script>
        const p = new URLSearchParams(window.location.search);
        const title = p.get('t') || "New Event";
        const start = p.get('s') || "20260101T090000"; // Format: YYYYMMDDTHHMMSS
        const loc = p.get('l') || "Location TBD";

        // Display info on page
        document.getElementById('title').innerText = title;
        
        // Simple date formatting for display (Optional)
        const dateStr = start.substring(4,6) + "/" + start.substring(6,8) + "/" + start.substring(0,4);
        document.getElementById('details').innerHTML = `<b>Date:</b> ${dateStr}<br><b>Location:</b> ${loc}`;

        // 1. Outlook Link
        document.getElementById('outLink').href = `https://outlook.office.com/calendar/0/deeplink/compose?subject=${encodeURIComponent(title)}&startdt=${start}&location=${encodeURIComponent(loc)}`;
        
        // 2. Google Link
        document.getElementById('gooLink').href = `https://calendar.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(title)}&dates=${start}/${start}&location=${encodeURIComponent(loc)}`;

        // 3. Default Calendar (.ics file generation)
        const icsData = `BEGIN:VCALENDAR\nVERSION:2.0\nBEGIN:VEVENT\nSUMMARY:${title}\nDTSTART:${start}\nLOCATION:${loc}\nEND:VEVENT\nEND:VCALENDAR`;
        document.getElementById('icsLink').href = "data:text/calendar;charset=utf8," + encodeURIComponent(icsData);
        document.getElementById('icsLink').setAttribute("download", "event.ics");
    </script>
</body>
</html>
